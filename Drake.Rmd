---
title: "Drake"
output: html_notebook
---


## Carga de librerías

```{r, echo=FALSE}
library(drake)
library(dplyr)
library(ggplot2)
```


## Funcións de traballo

```{r}
grafica <- function(data) {
  ggplot(data, aes(x = Petal.Width, fill = Species)) +
    geom_histogram()
}
```


## Funcións

```{r}
mi_plan<-drake_plan(hist=grafica())
plan

```





## Creación do plan
```{r}

plan <- drake_plan(
 
  data = iris %>%
    mutate(Species = forcats::fct_inorder(Species)),
  hist = grafica(data),
  fit = lm(Sepal.Width ~ Petal.Width + Species, data)#,
  # report = rmarkdown::render(
  #   knitr_in("Fluxo.Rmd"),
  #   output_file = file_out("Fluxo.html"),
  #   quiet = TRUE
  #)
)
plan
```


## Lanzamento do plan

```{r}
make(plan)

config <- drake_config(plan)
vis_drake_graph(config) # Interactive graph: zoom, drag, etc.

```



## Lectura e recuperación de "targets"

```{r}
readd(data) # Leer un "target"
readd(hist)
loadd(hist)
loadd() ## Carga tódolos targets 
```



## Modificación da función

```{r}
grafica <- function(data) {
  ggplot(data, aes(x = Petal.Width, fill = Species)) +
    geom_histogram(binwidth = 0.25) +
    theme_gray(20)
}
```


```{r}
config <- drake_config(plan)
vis_drake_graph(config) # Visualizalos cambios
```

